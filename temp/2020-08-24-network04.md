---
title: "ğŸ’» 04. HTTP êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ "
categories: network
tags: [ network ]
---

# HTTP ì¿ í‚¤

# êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ  (CORS)

- ì›¹ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë‹¤ë¥¸ ë„ë©”ì¸ì— ìœ„ì¹˜í•œ ì„œë²„ë¡œ ìš”ì²­ì„ í•´ì•¼ í•  ìƒí™©ì´ ìƒê¸´ë‹¤.
- ì›ë˜ ë„ë©”ì¸ì´ ë‹¤ë¥´ë©´ ìš”ì²­ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ì—†ê²Œ í•˜ë ¤ëŠ” ê²Œ ì›¹ë¸Œë¼ìš°ì €ì˜ ì£¼ìš” ì •ì±…ì´ì—ˆë‹¤. ë³´ì•ˆ ë¬¸ì œê°€ ìˆì—ˆê¸° ë•Œë¬¸ì´ë‹¤. 
- ê·¸ëŸ¬ë‚˜ ì ì  ì›¹ì‚¬ì´íŠ¸ì—ì„œ í•  ìˆ˜ ìˆëŠ” ì¼ë“¤ì´ ë§ì•„ì¡Œë‹¤: ë‹¨ìˆœ ë¬¸ì„œ ì œê³µ ì¼ì´ ì•„ë‹ˆë¼, ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ê¸° ì‹œì‘í•œ ê²ƒì´ë‹¤. ê·¸ëŸ° ê³¼ë„ê¸°ì ì¸ ìƒíƒœê°€ ë˜ë‹ˆê¹Œ ê¸°ì¡´ ì›¹ë¸Œë¼ìš°ì € ë³´ì•ˆì •ì±… ë•Œë¬¸ì— ë¶ˆí¸í•œ ì ì´ ìƒê¸´ë‹¤.
- ì˜ˆì‹œ) ë‚ ì”¨ ìœ„ì ¯ì„ ì‚¬ì´íŠ¸ì— í¬í•¨ì‹œí‚¬ ê²ƒì´ë‹¤.
  - ë°©ë²•1) ì§ì ‘ êµ¬ì¶•í•œ ì›¹ì„œë²„ì— ë‚ ì”¨ ê°€ì ¸ì˜¤ëŠ” route ì¶”ê°€í•˜ê³  ë¶€ë¥´ë©´ ë‚ ì”¨ api ì„œë²„ì— ë‹¤ì‹œ ìš”ì²­ì„ í•´ì„œ ë‚ ì”¨ ì •ë³´ë¥¼ ë°›ì•„ì™€ì„œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë³´ì—¬ì£¼ëŠ” ê²ƒ (weather api server - web server - web browser)
  - ë°©ë²•2) ì›¹ ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ë°”ë¡œ api ì„œë²„ì™€ ìš”ì²­ì„ ì£¼ê³ ë°›ëŠ”ë‹¤.
    - Weather API Server - web browser
- ê·¸ëŸ¬ë‹¤ CORSë¥¼ í†µí•˜ë©´ ê°€ëŠ¥í•˜ê²Œë” í’€ì–´ì§€ê²Œ ë˜ì—ˆë‹¤. 



## ë™ì¼ ì¶œì²˜ ì •ì±… (SOP: Same-Origin Policy)

- ì–´ë–¤ ì¶œì²˜(origin)ì—ì„œ ë¶ˆëŸ¬ì˜¨ ë¬¸ì„œë‚˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ë‹¤ë¥¸ ì¶œì²˜ì—ì„œ ê°€ì ¸ì˜¨ ë¦¬ì†ŒìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê²ƒì„ ì œí•œí•˜ëŠ” ì¤‘ìš”í•œ ë³´ì•ˆ ë°©ì‹ì´ë‹¤,
- ì¶œì²˜ê°€ ê°™ë‹¤ëŠ” ê²ƒì€ ë‘ URLì˜ í”„ë¡œí† ì½œ, í˜¸ìŠ¤íŠ¸, í¬íŠ¸ ì„¸ ê°œê°€ ê°™ë‹¤ëŠ” ê²ƒì„ ë§í•œë‹¤. 



## í¬ë¡œìŠ¤ ë„ë©”ì¸ (Cross Domain) ì´ìŠˆ

- Ajaxê°€ ë‚˜ì˜¤ê³  Open APIê°€ í™œë°œí•´ì§€ë©´ì„œ SOP ë•Œë¬¸ì— ë¬¸ì œê°€ ìƒê¸´ë‹¤. SOP ë•Œë¬¸ì— ìë°”ìŠ¤í¬ë¦½íŠ¸(XMLHttpRequest)ë¡œ ë‹¤ë¥¸ ì›¹ í˜ì´ì§€ì— ì ‘ê·¼í•  ë•Œ ê°™ì€ ì¶œì²˜(Same Origin)ì˜ í˜ì´ì§€ì—ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆì—ˆë‹¤.

- SOPë¥¼ ìš°íšŒí•´ì„œ ì„œë¡œ ë‹¤ë¥¸ ë„ë©”ì¸ ê°„ì— í†µì‹ ì„ í•  ìˆ˜ ìˆê²Œ í•´ì¤„ ë¬´ì–¸ê°€ê°€ í•„ìš”í•˜ê²Œ ë˜ì—ˆë‹¤. 
- ê°€ì¥ ë§ì´ ì´ìš©í•œ ë°©ë²• 
  - JSONP
  - Reverse Proxy
  - Flash Socket



## CORSì˜ ë“±ì¥

- ì›¹ë¸Œë¼ìš°ì € ì…ì¥ì—ì„œëŠ” ì´ ìš°íšŒë¡œë¥¼ ê·¸ëƒ¥ ë‘ê¸°ì—ëŠ” ë³´ì•ˆìƒì˜ ë¬¸ì œê°€ ì»¤ì§€ê³ , ë§‰ìë‹ˆ CORSì— ëŒ€í•œ ìˆ˜ìš”ê°€ ë„ˆë¬´ ë§ì•˜ë‹¤. ë”°ë¼ì„œ í¬ë¡œìŠ¤ ë„ë©”ì¸ ì´ìŠˆë¥¼ í•´ê²°í•  í‘œì¤€ì˜ í•„ìš”ì„±ì´ ëŒ€ë‘ë˜ì—ˆë‹¤. 

- W3Cì—ì„œ ê¶Œì¥ì‚¬í•­ìœ¼ë¡œ CORS ì‚¬ì–‘ ë°œí‘œ
- í˜„ì¬ í™œë°œí•˜ê²Œ ìœ ì§€ ê´€ë¦¬ë˜ëŠ” ì‚¬ì–‘ì€ WHATWGì˜ Fetch Living Standard



## CORSë€?

- Cross-Origin Resource Sharing

- ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì™¸ë¶€ ë„ë©”ì¸ ì„œë²„ì™€ í†µì‹ í•˜ê¸° ìœ„í•œ ë°©ì‹ì„ í‘œì¤€í™”í•œ ìŠ¤í™ì´ë‹¤.
- ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ **ì •í•´ì§„ í—¤ë”ë¥¼ í†µí•´** ì„œë¡œ ìš”ì²­ì´ë‚˜ ì‘ë‹µì— ë°˜ì‘í•  ì§€ ê²°ì •í•˜ëŠ” ë°©ì‹ì´ë‹¤. 
- ì„œë¡œ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì£¼ê³ ë°›ê¸° ìœ„í•´ì„œëŠ” ì›¹ í”„ë¡ íŠ¸ì—”ë“œì™€ ì„œë²„ì—ì„œ íŠ¹ì •í•œ ì‘ì—…ì„ í•´ì¤˜ì•¼ í•œë‹¤.
  - í”„ë¡ íŠ¸ì—”ë“œ: request í—¤ë”ì— CORS ê´€ë ¨ ì˜µì…˜ì„ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.
  - ì„œë²„: response í—¤ë”ì— í•´ë‹¹í•˜ëŠ” í”„ë¡ íŠ¸ì˜ ìš”ì²­ì„ í—ˆìš©í•œë‹¤ëŠ” ë‚´ìš©ì„ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.
- HTTP OPTION Method
  - CORS ìš”ì²­ì„ ë³´ë‚´ëŠ” ì‘ì—…: ì„œë²„ë¡œ í•œ ë²ˆë§Œ ë³´ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤.
  - ì„œë²„ë¡œ ìš”ì²­ì„ 2ë²ˆ ë³´ë‚¸ë‹¤. ë¨¼ì € OPTION ë©”ì„œë“œë¡œ í—ˆìš©í•  ê²ƒì¸ì§€ ë¬¼ì–´ë³´ëŠ” ìš”ì²­ì„ í•œë‹¤. ì„œë²„ê°€ OKë¥¼ í•˜ë©´ getì´ë‚˜ post ìš”ì²­ì„ í•´ì„œ ì‘ë‹µì„ ë°›ëŠ” ê²ƒ.
  - ì´ê±¸ ì˜ ì´ìš©í•˜ë©´ íŠ¹ì • ë„ë©”ì¸ì—ì„œ ì˜¤ëŠ” ìš”ì²­ì´ë‚˜ íŠ¹ì • ë¼ìš°í„°ì—ì„œ ì˜¤ëŠ” ìš”ì²­ì„ í—ˆìš©í•  ìˆ˜ ìˆë‹¤. 

> ë³´í†µì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•Œì•„ì„œ ë‹¤ í•´ì£¼



## CORSì˜ ë™ì‘ ë°©ì‹

### ê°„ë‹¨í•œ ìš”ì²­(Simple Request)

- ê¸°ì¡´ ë°ì´í„°ì— ë¶€ì‘ìš©ì„ ì¼ìœ¼í‚¤ì§€ ì•ŠëŠ” ìš”ì²­
- CORS **ì‚¬ì „ ìš”ì²­**ì„ ë°œìƒì‹œí‚¤ì§€ ì•ŠëŠ” ìš”ì²­
- ì¡°ê±´
  - GET, HEAD, POST ì¤‘ í•œ ê°€ì§€ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.
  - Custom Header ë¶ˆí¬í•¨
  - POSTì¼ ê²½ìš° Content-Typeì´ ì•„ë˜ ì…‹ ì¤‘ í•˜ë‚˜ë¥¼ ë§Œì¡±
    - application/x-www-form-urlencoded
    - multipart/form-data
    - text/plain
- ì˜ˆì‹œ

```javascript
var invocation = new XMLHttpRequest();
var url = 'http://bar.other/resources/public-data/';

function callOtherDomain() {
    if (invocation) {
        invacation.open('GET', url, true);
        invocation.onreadystatechange = handler;
        invocation.send();
    }
}
```



### ì‚¬ì „ ìš”ì²­

- ë³¸ ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ì— ì‚¬ì „ ìš”ì²­ì„ ë³´ë‚´ì„œ ì„œë²„ê°€ ì´ì— ì‘ë‹µì´ ê°€ëŠ¥í•œ ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•
- ì‚¬ì „ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²½ìš°
  - GET, HEAD, POST ì´ì™¸ì˜ ìš”ì²­
  - Custom Header í¬í•¨
  - POST ìš”ì²­ì¼ ê²½ìš° Content-Typeì´ ì•„ë˜ ì…‹ì„ ë§Œì¡±í•˜ì§€ ì•Šì„ ë•Œ
    - application/x-www-form-urlencoded
    - multipart/form-data
    - text/plain
- ì‚¬ì „ ìš”ì²­ ê³¼ì •
  - 1. ë™ì¼í•œ URLì— OPTIONS methodë¡œ ìš”ì²­(Preflight)
  - 2. <1> ìš”ì²­ì— ëŒ€í•´ ì„œë²„ì—ì„œëŠ” í—ˆìš©ë˜ëŠ” method,  í—ˆìš©í•˜ëŠ” í—¤ë”, ì¿ í‚¤ í—ˆìš© ì—¬ë¶€ë¥¼ ì‘ë‹µ
  - 3. <2> ìš”ì²­ì˜ ì‘ë‹µì´ ìš”ì²­ì„ í—ˆìš©í•˜ëŠ” ì¡°ê±´ì´ë¼ë©´ ë³¸ ìš”ì²­ì„ ë³´ë‚¸ë‹¤.

```javascript
const invocation = new XMLHttpRequest();
const url = 'http://bar.other/resource/post-here/';
const body = '<?xml version="1.0"?><person><name>moni</name></person>'

function callOtherDomain() {
    if (invocation) {
        invocation.open('POST', url, true);
        // ì»¤ìŠ¤í…€í—¤ë”
        invocation.setRequestHeader('MYCUSTOMHEADER', 'monimoni');
        invocation.setRequestHeader('Content-Type', 'application/xml');
        invocation.onreadystatechange = handler;
        invocation.send(body);
    }
}
```



### ì¸ì¦ì„ ì´ìš©í•œ ìš”ì²­

- XHRì€ ê¸°ë³¸ì ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ìš”ì²­ì— ì¿ í‚¤ë¥¼ í¬í•¨í•˜ê³  ì‹¶ë‹¤ë©´ `XMLHttpRequest` ê°ì²´ì˜ `withCredential` í”„ë¡œí¼í‹° ê°’ì„ trueë¡œ ì„¤ì •í•œë‹¤.
- ì„œë²„ ì¸¡ë„ `Access-Control-Allow-Credentials` ì‘ë‹µ í—¤ë”ë¥¼ trueë¡œ ì„¤ì •í•œë‹¤.

```javascript
var invocation = new XMLHttpRequest();
var url = 'http://bar.other/resources/credentialed-content/';

function callOtherDomain() {
    if(invocation) {
        invocation.open('GET', url, true);
        invocation.withCredentials = true;
        invocation.onreadystatechange = handler;
        invocation.send();
    }
}
```







## Reference

1. https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies

2. ìƒí™œì½”ë”©: Node.js - ì¿ í‚¤ì™€ ì¸ì¦ ì‹œë¦¬ì¦ˆ: https://youtu.be/i51xW3eh-T4

3. [https://ko.wikipedia.org/wiki/%EC%82%AC%EC%9D%B4%ED%8A%B8_%EA%B0%84_%EC%9A%94%EC%B2%AD_%EC%9C%84%EC%A1%B0](https://ko.wikipedia.org/wiki/ì‚¬ì´íŠ¸_ê°„_ìš”ì²­_ìœ„ì¡°)

4. http://it.chosun.com/site/data/html_dir/2020/02/16/2020021600579.html

5. https://gmyankee.tistory.com/86

6. http://wiki-camp.appspot.com/%5B%EB%B2%88%EC%97%AD%5D_HTTP_Cookie_%28Wikipedia%29?rev=2

7. https://ko.wikipedia.org/wiki/%EC%B6%94%EC%A0%81_%EA%B8%88%EC%A7%80

